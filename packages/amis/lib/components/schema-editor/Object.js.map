{
    "version": 3,
    "file": "Object.js",
    "sourceRoot": "",
    "sources": [
        "/src/components/schema-editor/Object.tsx"
    ],
    "names": [],
    "mappings": "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",
    "sourcesContent": [
        "import React from 'react';\nimport type {JSONSchema} from '../../utils/DataScope';\nimport {autobind, guid} from '../../utils/helper';\nimport Button from '../Button';\nimport {Icon} from '../icons';\nimport InputBox from '../InputBox';\nimport {SchemaEditorItemCommon, SchemaEditorItemCommonProps} from './Common';\nimport {SchemaEditorItem} from './Item';\n\nexport interface SchemaEditorItemObjectState {\n  members: Array<{\n    id: string;\n    key: string;\n    hasError?: boolean;\n    required?: boolean;\n    schema: JSONSchema;\n  }>;\n  collapsed: boolean;\n}\n\nexport class SchemaEditorItemObject extends SchemaEditorItemCommon<\n  SchemaEditorItemCommonProps,\n  SchemaEditorItemObjectState\n> {\n  state = {\n    members: this.propsToMembers(this.props),\n    collapsed: false\n  };\n\n  lastValue: any;\n\n  componentDidUpdate(prevProps: SchemaEditorItemCommonProps) {\n    const props = this.props;\n\n    // 外部属性变化，更新 state\n    if (\n      props.value !== prevProps.value &&\n      JSON.stringify(props.value) !== JSON.stringify(this.lastValue)\n    ) {\n      this.setState({\n        members: this.propsToMembers(props)\n      });\n    }\n  }\n\n  propsToMembers(props: SchemaEditorItemCommonProps) {\n    const members: Array<{\n      id: string;\n      key: string;\n      hasError?: boolean;\n      required?: boolean;\n      schema: JSONSchema;\n    }> = [];\n    const required = Array.isArray(props.value?.required)\n      ? props.value!.required\n      : [];\n\n    if (props.value?.properties) {\n      const properties = props.value.properties;\n      Object.keys(properties).forEach(key => {\n        const value = properties[key] as any;\n\n        members.push({\n          id: guid(),\n          key: key || '',\n          hasError: !key || members.some(i => i.key === key),\n          required: !!~required.indexOf(key),\n          schema: value\n        });\n      });\n    }\n\n    return members;\n  }\n\n  @autobind\n  pipeOut() {\n    const members = this.state.members;\n    const {value, onChange} = this.props;\n    const properties: any = {};\n    const required: Array<string> = [];\n\n    members\n      .filter(item => !item.hasError)\n      .forEach(member => {\n        properties[member.key] = member.schema;\n\n        if (member.required) {\n          required.push(member.key);\n        }\n      });\n\n    this.lastValue = {\n      ...value,\n      properties,\n      required\n    };\n    onChange?.(this.lastValue);\n  }\n\n  @autobind\n  handleAdd() {\n    const members = this.state.members.concat();\n    members.push({\n      id: guid(),\n      key: '',\n      hasError: true,\n      required: false,\n      schema: {\n        type: 'string'\n      }\n    });\n\n    this.setState(\n      {\n        members\n      },\n      this.pipeOut\n    );\n  }\n\n  @autobind\n  handlePropKeyChange(index: number, key: string) {\n    const members = this.state.members.concat();\n    members[index] = {\n      ...members[index],\n      key,\n      hasError: !key || members.some((m, i) => i !== index && m.key === key)\n    };\n\n    this.setState({members}, this.pipeOut);\n  }\n\n  @autobind\n  handlePropTitleChange(index: number, title: string) {\n    const members = this.state.members.concat();\n    members[index] = {\n      ...members[index],\n      schema: {\n        ...members[index].schema,\n        title\n      }\n    };\n\n    this.setState({members}, this.pipeOut);\n  }\n\n  @autobind\n  handlePropRemove(index: number) {\n    const members = this.state.members.concat();\n    members.splice(index, 1);\n    this.setState({members}, this.pipeOut);\n  }\n\n  @autobind\n  handlePropChange(index: number, item: any) {\n    const members = this.state.members.concat();\n    members[index] = {\n      ...members[index],\n      schema: {\n        ...item\n      }\n    };\n\n    this.setState({members}, this.pipeOut);\n  }\n\n  @autobind\n  handlePropRequiredChange(index: number, required: boolean) {\n    const members = this.state.members.concat();\n    members[index] = {\n      ...members[index],\n      required\n    };\n\n    this.setState({members}, this.pipeOut);\n  }\n\n  @autobind\n  toggleCollapsed() {\n    this.setState({\n      collapsed: !this.state.collapsed\n    });\n  }\n\n  rendererProps() {\n    const {\n      value,\n      translate: __,\n      classnames: cx,\n      renderExtraProps,\n      renderModalProps,\n      locale,\n      classPrefix,\n      disabled,\n      showInfo,\n      types,\n      onTypeChange,\n      enableAdvancedSetting\n    } = this.props;\n    const members = this.state.members;\n\n    return (\n      <div\n        className={cx('SchemaEditorProps', {\n          'SchemaEditorProps--depth': showInfo !== false\n        })}\n      >\n        {members.length ? (\n          members.map((member, index) => (\n            <SchemaEditorItem\n              key={member.id}\n              types={types}\n              onTypeChange={onTypeChange}\n              enableAdvancedSetting={enableAdvancedSetting}\n              prefix={\n                <>\n                  <InputBox\n                    className={cx('SchemaEditor-key')}\n                    hasError={member.hasError}\n                    value={member.key || ''}\n                    onChange={this.handlePropKeyChange.bind(this, index)}\n                    placeholder={__('JSONSchema.key')}\n                    disabled={disabled || !!value?.$ref}\n                  />\n\n                  <InputBox\n                    className={cx('SchemaEditor-title')}\n                    value={member.schema.title || ''}\n                    onChange={this.handlePropTitleChange.bind(this, index)}\n                    placeholder={__('JSONSchema.title')}\n                    disabled={disabled || !!value?.$ref}\n                  />\n                </>\n              }\n              affix={\n                <Button\n                  className={cx('SchemaEditor-btn')}\n                  onClick={this.handlePropRemove.bind(this, index)}\n                  iconOnly\n                  disabled={disabled || !!value?.$ref}\n                >\n                  <Icon icon=\"remove\" className=\"icon\" />\n                </Button>\n              }\n              value={member.schema}\n              onChange={this.handlePropChange.bind(this, index)}\n              renderExtraProps={renderExtraProps}\n              renderModalProps={renderModalProps}\n              locale={locale}\n              translate={__}\n              classnames={cx}\n              classPrefix={classPrefix}\n              disabled={disabled || !!value?.$ref}\n              required={member.required}\n              onRequiredChange={this.handlePropRequiredChange.bind(this, index)}\n            />\n          ))\n        ) : (\n          <div className={cx('SchemaEditorProps-placeholder')}>\n            {__('placeholder.empty')}\n          </div>\n        )}\n\n        <Button\n          level=\"link\"\n          onClick={this.handleAdd}\n          size=\"xs\"\n          disabled={disabled || !!value?.$ref}\n        >\n          {__('JSONSchema.add_prop')}\n        </Button>\n      </div>\n    );\n  }\n\n  render() {\n    const {classnames: cx, showInfo, translate: __, disabled} = this.props;\n\n    return (\n      <div\n        className={cx('SchemaEditorItem SchemaEditorObject', {\n          'is-collapsed': this.state.collapsed\n        })}\n      >\n        {showInfo !== false ? (\n          <>\n            <a\n              className={cx('SchemaEditor-caret', {\n                'is-collapsed': this.state.collapsed\n              })}\n              onClick={this.toggleCollapsed}\n            >\n              <Icon icon=\"caret\" className=\"icon\" />\n            </a>\n            {this.renderCommon()}\n          </>\n        ) : null}\n        {this.state.collapsed ? null : this.rendererProps()}\n      </div>\n    );\n  }\n}\n"
    ]
}