{
    "version": 3,
    "file": "Avatar.js",
    "sourceRoot": "",
    "sources": [
        "/src/components/Avatar.tsx"
    ],
    "names": [],
    "mappings": "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",
    "sourcesContent": [
        "import * as React from 'react';\nimport {ClassNamesFn, themeable, ThemeProps} from '../theme';\n\n/**\n * Avatar 属性\n */\ninterface AvatarCmptProps extends ThemeProps {\n  style?: {\n    [prop: string]: any\n  };\n  className?: string;\n  classnames: ClassNamesFn;\n\n  /**\n   * 图片地址\n   */\n  src?: string | React.ReactNode;\n\n  /**\n   * 图标\n   */\n  icon?: string | React.ReactNode;\n\n  /**\n   * 图片相对于容器的缩放方式\n   */\n  fit?: 'fill' | 'contain' | 'cover' | 'none' | 'scale-down';\n\n  /**\n   * 形状\n   */\n  shape?: 'circle' | 'square' | 'rounded';\n\n  /**\n   * 大小\n   */\n  size?: number | 'small' | 'default' | 'large';\n\n  /**\n   * 文本\n   */\n  text?: string;\n\n  /**\n   * 字符类型距离左右两侧边界单位像素\n   */\n  gap?: number;\n\n  /**\n   * 图片无法显示时的替换文字地址\n   */\n  alt?: string;\n\n  /**\n   * 图片是否允许拖动\n   */\n  draggable?: boolean;\n\n  /**\n   * 图片CORS属性\n   */\n  crossOrigin?: 'anonymous' | 'use-credentials' | '';\n\n  /**\n   * 图片加载失败的事件，返回 false 会关闭组件默认的\n   */\n  onError?: (event: React.SyntheticEvent<HTMLImageElement, Event>) => boolean;\n\n  /**\n   * \n   */\n  children?: JSX.Element | ((props?: any) => JSX.Element)\n}\n\nconst prefix = 'Avatar--';\nconst childPrefix = prefix + 'text';\n\nexport interface AvatarState {\n  scale: number;\n  hasImg: boolean;\n}\n\nexport class Avatar extends React.Component<AvatarCmptProps, AvatarState> {\n  static defaultProps: Partial<AvatarCmptProps> = {\n    shape: 'circle',\n    size: 'default',\n    fit: 'cover',\n    gap: 4\n  };\n\n  state: AvatarState = {\n    scale: 1,\n    hasImg: true\n  };\n\n  avatarChildrenRef: React.RefObject<HTMLElement>;\n  avatarRef: React.RefObject<HTMLElement>;\n\n  constructor(props: AvatarCmptProps) {\n    super(props);\n    \n    this.avatarChildrenRef = React.createRef();\n    this.avatarRef = React.createRef();\n\n    this.handleImageLoadError = this.handleImageLoadError.bind(this);\n  }\n\n  componentDidMount() {\n    this.setScaleByGap();\n  }\n\n  componentDidUpdate(prevProps: AvatarCmptProps, prevState: AvatarState) {\n    const {src, gap, text, children} = this.props;\n    const {hasImg} = this.state;\n    if (prevProps.src !== src) {\n      this.setState({\n        hasImg: !!src\n      });\n    }\n    if ((prevState.hasImg && !hasImg)\n      || (prevProps.text !== text)\n      || (prevProps.children !== children)\n      || (prevProps.gap !== gap)) {\n      this.setScaleByGap();\n    }\n  }\n\n  handleImageLoadError(event: React.SyntheticEvent<HTMLImageElement, Event>) {\n    const {onError} = this.props;\n    this.setState({\n      hasImg: onError ? !onError(event) : false\n    });\n  }\n\n  setScaleByGap() {\n    const {gap = 4} = this.props;\n    if (!this.avatarChildrenRef.current || !this.avatarRef.current) {\n      return;\n    }\n    const childrenWidth = this.avatarChildrenRef.current.offsetWidth;\n    const nodeWidth = this.avatarRef.current.offsetWidth;\n    if (childrenWidth && nodeWidth) {\n      if (gap * 2 < nodeWidth) {\n        const diff = nodeWidth - gap * 2;\n        this.setState({\n          scale: diff < childrenWidth ? diff / childrenWidth : 1\n        });\n      }\n    }\n  };\n\n  render() {\n    let {\n      style = {},\n      className,\n      shape,\n      size,\n      src,\n      icon,\n      alt,\n      draggable,\n      crossOrigin,\n      fit,\n      text,\n      children,\n      classnames: cx\n    } = this.props;\n\n    const {scale, hasImg} = this.state;\n  \n    const isImgRender = React.isValidElement(src);\n    const isIconRender = React.isValidElement(icon);\n  \n    let childrenRender;\n  \n    let sizeStyle = {};\n    let sizeClass = '';\n  \n    if (typeof size === 'number') {\n      sizeStyle = {\n        height: size,\n        width: size,\n        lineHeight: size + 'px'\n      };\n    }\n    else if (typeof size === 'string') {\n      sizeClass = size === 'large'\n        ? `${prefix}lg` \n        : size === 'small' ? `${prefix}sm` : '';\n    }\n  \n    const scaleX = `scale(${scale}) translateX(-50%)`;\n    const scaleStyle = {\n      msTransform: scaleX,\n      WebkitTransform: scaleX,\n      transform: scaleX\n    };\n  \n    if (typeof src === 'string' && hasImg) {\n      const imgStyle = fit ? {objectFit: fit} : {};\n      childrenRender = (\n        <img\n          style={imgStyle}\n          src={src}\n          alt={alt}\n          draggable={draggable}\n          onError={this.handleImageLoadError}\n          crossOrigin={crossOrigin}\n        />\n      );\n    }\n    else if (isImgRender) {\n      childrenRender = src;\n    }\n    else if (typeof text === 'string' || typeof text === 'number') {\n      childrenRender = (\n        <span\n          className={cx(childPrefix)}\n          ref={this.avatarChildrenRef}\n          style={scaleStyle}>\n          {text}\n        </span>\n      );\n    }\n    else if (typeof icon === 'string') {\n      childrenRender = (<i className={icon} />);\n    }\n    else if (isIconRender) {\n      childrenRender = icon;\n    }\n    else {\n      childrenRender = (\n        <span\n          className={cx(childPrefix)}\n          ref={this.avatarChildrenRef}\n          style={scaleStyle}>\n          {children}\n        </span>\n      );\n    }\n  \n    return (\n      <span\n        className={cx(`Avatar`, className, prefix + shape, sizeClass)}\n        style={{...sizeStyle, ...style}}\n        ref={this.avatarRef}>\n        {childrenRender}\n      </span>\n    );\n  }  \n}\n\nexport default themeable(Avatar);\n"
    ]
}