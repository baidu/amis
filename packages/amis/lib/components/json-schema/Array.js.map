{
    "version": 3,
    "file": "Array.js",
    "sourceRoot": "",
    "sources": [
        "/src/components/json-schema/Array.tsx"
    ],
    "names": [],
    "mappings": "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",
    "sourcesContent": [
        "import React from 'react';\nimport {guid} from '../../utils/helper';\nimport Button from '../Button';\nimport {Icon} from '../icons';\nimport type {InputJSONSchemaItemProps} from './index';\nimport {InputJSONSchemaItem} from './Item';\n\ntype JSONSchemaArrayMember = {\n  key: string;\n  index: number;\n  schema?: any;\n  invalid?: boolean;\n};\nexport function InputJSONSchemaArray(props: InputJSONSchemaItemProps) {\n  const {\n    classnames: cx,\n    value,\n    onChange,\n    disabled,\n    translate: __,\n    collapsable,\n    renderValue\n  } = props;\n  const buildMembers = React.useCallback((schema: any, value) => {\n    const members: Array<JSONSchemaArrayMember> = [];\n\n    let len = Array.isArray(value) ? value.length : 1;\n\n    if (typeof schema.minContains === 'number') {\n      len = Math.max(len, schema.minContains);\n    }\n\n    const maxContains =\n      typeof schema.maxContains === 'number' ? schema.maxContains : 0;\n\n    while (len--) {\n      members.push({\n        key: guid(),\n        index: members.length,\n        schema: schema.items,\n        invalid: maxContains ? maxContains < members.length : false\n      });\n    }\n\n    return members;\n  }, []);\n\n  const [members, setMembers] = React.useState<Array<JSONSchemaArrayMember>>(\n    buildMembers(props.schema, value)\n  );\n\n  const membersRef = React.useRef(members);\n  membersRef.current = members;\n\n  const [collapsed, setCollapsed] = React.useState<boolean>(\n    collapsable ? true : false\n  );\n  const toggleCollapsed = () => {\n    setCollapsed(!collapsed);\n  };\n\n  const onMemberChange = (member: JSONSchemaArrayMember, memberValue: any) => {\n    const newValue = Array.isArray(props.value) ? props.value.concat() : [];\n    newValue[member.index] = memberValue;\n    onChange?.(newValue);\n  };\n  const onMemberDelete = (member: JSONSchemaArrayMember) => {\n    const idx = members.indexOf(member);\n    if (!~idx) {\n      throw new Error('member object not found');\n    }\n\n    const m = members.concat();\n    m.splice(idx, 1);\n    setMembers(m);\n\n    const newValue = Array.isArray(props.value) ? props.value.concat() : [];\n    newValue.splice(member.index, 1);\n    onChange?.(newValue);\n  };\n\n  React.useEffect(() => {\n    setMembers(buildMembers(props.schema, props.value));\n  }, [JSON.stringify(props.schema)]);\n\n  React.useEffect(() => {\n    const value = props.value;\n    const schema = props.schema;\n    let len = Array.isArray(value) ? value.length : 1;\n\n    if (typeof schema.minContains === 'number') {\n      len = Math.max(len, schema.minContains);\n    }\n\n    if (typeof schema.maxContains === 'number') {\n      len = Math.min(schema.maxContains, len);\n    }\n    const m = membersRef.current!.concat();\n\n    if (m.length !== len) {\n      while (m.length !== len) {\n        if (m.length > len) {\n          m.pop();\n        } else {\n          m.push({\n            key: guid(),\n            index: m.length,\n            schema: schema.items\n          });\n        }\n      }\n      setMembers(m);\n    }\n  }, [JSON.stringify(props.value)]);\n\n  const handleAdd = React.useCallback(() => {\n    const m = members.concat();\n    m.push({\n      key: guid(),\n      index: members.length,\n      schema: props.schema.items,\n      invalid: false\n    });\n    setMembers(m);\n  }, [members]);\n\n  const maxContains =\n    typeof props.schema?.maxContains === 'number'\n      ? props.schema.maxContains\n      : 0;\n\n  const minContains =\n    typeof props.schema?.minContains === 'number'\n      ? props.schema.minContains\n      : 0;\n\n  // todo additionalProperties 还有其他格式\n  const allowAdd = !maxContains || maxContains > members.length;\n  const allowDelete = !minContains || minContains < members.length;\n\n  return (\n    <>\n      {collapsable ? (\n        <a\n          className={cx('JSONSchemaObject-caret', {\n            'is-collapsed': collapsed\n          })}\n          onClick={toggleCollapsed}\n        >\n          <Icon icon=\"caret\" className=\"icon\" />\n        </a>\n      ) : null}\n\n      <div\n        className={cx('JSONSchemaObject', {\n          'is-expanded': collapsable && !collapsed\n        })}\n      >\n        {collapsed ? (\n          renderValue ? (\n            <InputJSONSchemaItem\n              {...props}\n              value={value}\n              onChange={onChange}\n              schema={{\n                type: 'string'\n              }}\n              placeholder={props.schema?.description}\n            />\n          ) : null\n        ) : (\n          members.map(member => {\n            return (\n              <div key={member.key} className={cx('JSONSchemaMember')}>\n                <div className={cx('JSONSchemaMember-value')}>\n                  <InputJSONSchemaItem\n                    {...props}\n                    value={value?.[member.index]}\n                    onChange={onMemberChange.bind(null, member)}\n                    schema={\n                      member.schema || {\n                        type: 'string'\n                      }\n                    }\n                    collapsable\n                  />\n                </div>\n                {allowDelete ? (\n                  <Button\n                    className={cx('SchemaEditor-btn')}\n                    onClick={onMemberDelete.bind(null, member)}\n                    iconOnly\n                    disabled={disabled || !!value?.$ref}\n                  >\n                    <Icon icon=\"remove\" className=\"icon\" />\n                  </Button>\n                ) : null}\n              </div>\n            );\n          })\n        )}\n\n        {!collapsed ? (\n          <Button\n            level=\"link\"\n            onClick={handleAdd}\n            size=\"xs\"\n            disabled={disabled || !allowAdd}\n          >\n            {__('JSONSchema.add_prop')}\n          </Button>\n        ) : null}\n      </div>\n    </>\n  );\n}\n"
    ]
}