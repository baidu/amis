{
    "version": 3,
    "file": "RootRenderer.js",
    "sourceRoot": "",
    "sources": [
        "/src/RootRenderer.tsx"
    ],
    "names": [],
    "mappings": "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",
    "sourcesContent": [
        "import {observer} from 'mobx-react';\nimport {getEnv} from 'mobx-state-tree';\nimport React from 'react';\nimport Alert from './components/Alert2';\nimport Spinner from './components/Spinner';\nimport {renderChild, RootProps} from './Root';\nimport {IScopedContext, ScopedContext} from './Scoped';\nimport {IRootStore, RootStore} from './store/root';\nimport {Action} from './types';\nimport {bulkBindFunctions, guid, isVisible} from './utils/helper';\nimport {filter} from './utils/tpl';\nimport qs from 'qs';\nimport pick from 'lodash/pick';\nimport mapValues from 'lodash/mapValues';\n\nexport interface RootRendererProps extends RootProps {\n  location?: any;\n}\n\n@observer\nexport class RootRenderer extends React.Component<RootRendererProps> {\n  store: IRootStore;\n  static contextType = ScopedContext;\n\n  constructor(props: RootRendererProps) {\n    super(props);\n\n    this.store = props.rootStore.addStore({\n      id: guid(),\n      path: this.props.$path,\n      storeType: RootStore.name,\n      parentId: ''\n    }) as IRootStore;\n\n    this.store.initData(props.data);\n    this.store.updateLocation(props.location);\n\n    bulkBindFunctions<RootRenderer /*为毛 this 的类型自动识别不出来？*/>(this, [\n      'handleAction',\n      'handleDialogConfirm',\n      'handleDialogClose',\n      'handleDrawerConfirm',\n      'handleDrawerClose',\n      'handlePageVisibilityChange'\n    ]);\n  }\n\n  componentDidMount() {\n    document.addEventListener(\n      'visibilitychange',\n      this.handlePageVisibilityChange\n    );\n  }\n\n  componentDidUpdate(prevProps: RootRendererProps) {\n    const props = this.props;\n\n    if (props.data !== prevProps.data) {\n      this.store.initData(props.data);\n    }\n\n    if (props.location !== prevProps.location) {\n      this.store.updateLocation(props.location);\n    }\n  }\n\n  componentDidCatch(error: any, errorInfo: any) {\n    this.store.setRuntimeError(error, errorInfo);\n  }\n\n  componentWillUnmount() {\n    this.props.rootStore.removeStore(this.store);\n    document.removeEventListener(\n      'visibilitychange',\n      this.handlePageVisibilityChange\n    );\n  }\n\n  handlePageVisibilityChange() {\n    const env = this.props.env;\n    if (document.visibilityState === 'hidden') {\n      env?.tracker({\n        eventType: 'pageHidden'\n      });\n    } else if (document.visibilityState === 'visible') {\n      env?.tracker({\n        eventType: 'pageVisible'\n      });\n    }\n  }\n\n  handleAction(\n    e: React.UIEvent<any> | void,\n    action: Action,\n    ctx: object,\n    throwErrors: boolean = false,\n    delegate?: IScopedContext\n  ) {\n    const {env, messages, onAction} = this.props;\n    const store = this.store;\n\n    if (\n      onAction?.(e, action, ctx, throwErrors, delegate || this.context) ===\n      false\n    ) {\n      return;\n    }\n\n    const scoped = delegate || this.context;\n    if (action.actionType === 'reload') {\n      action.target && scoped.reload(action.target, ctx);\n    } else if (action.target) {\n      action.target.split(',').forEach(name => {\n        let target = scoped.getComponentByName(name);\n        target &&\n          target.doAction &&\n          target.doAction(\n            {\n              ...action,\n              target: undefined\n            },\n            ctx\n          );\n      });\n    } else if (\n      action.actionType === 'url' ||\n      action.actionType === 'link' ||\n      action.actionType === 'jump'\n    ) {\n      if (!env || !env.jumpTo) {\n        throw new Error('env.jumpTo is required!');\n      }\n\n      env.jumpTo(\n        filter(\n          (action.to || action.url || action.link) as string,\n          ctx,\n          '| raw'\n        ),\n        action,\n        ctx\n      );\n    } else if (action.actionType === 'email') {\n      const mailTo = filter(action.to, ctx);\n      const mailInfo = mapValues(\n        pick(action, 'to', 'cc', 'bcc', 'subject', 'body'),\n        val => filter(val, ctx)\n      );\n      const mailStr = qs.stringify(mailInfo);\n      const mailto = `mailto:${mailTo}?${mailStr}`;\n\n      window.open(mailto);\n    } else if (action.actionType === 'dialog') {\n      store.setCurrentAction(action);\n      store.openDialog(ctx);\n    } else if (action.actionType === 'drawer') {\n      store.setCurrentAction(action);\n      store.openDrawer(ctx);\n    } else if (action.actionType === 'toast') {\n      action.toast?.items?.forEach((item: any) => {\n        env.notify(\n          item.level || 'info',\n          item.body\n            ? renderChild('body', item.body, {\n                ...this.props,\n                data: ctx\n              })\n            : '',\n          {\n            ...action.toast,\n            ...item,\n            title: item.title\n              ? renderChild('title', item.title, {\n                  ...this.props,\n                  data: ctx\n                })\n              : null,\n            useMobileUI: env.useMobileUI\n          }\n        );\n      });\n    } else if (action.actionType === 'ajax') {\n      store.setCurrentAction(action);\n      store\n        .saveRemote(action.api as string, ctx, {\n          successMessage:\n            (action.messages && action.messages.success) ||\n            (messages && messages.saveSuccess),\n          errorMessage:\n            (action.messages && action.messages.failed) ||\n            (messages && messages.saveSuccess)\n        })\n        .then(async () => {\n          if (action.feedback && isVisible(action.feedback, store.data)) {\n            await this.openFeedback(action.feedback, store.data);\n          }\n\n          const redirect =\n            action.redirect && filter(action.redirect, store.data);\n          redirect && env.jumpTo(redirect, action);\n          action.reload &&\n            this.reloadTarget(\n              delegate || this.context,\n              action.reload,\n              store.data\n            );\n        })\n        .catch(e => {\n          if (throwErrors || action.countDown) {\n            throw e;\n          }\n        });\n    } else if (\n      action.actionType === 'copy' &&\n      (action.content || action.copy)\n    ) {\n      env.copy &&\n        env.copy(filter(action.content || action.copy, ctx, '| raw'), {\n          format: action.copyFormat\n        });\n    }\n  }\n\n  handleDialogConfirm(values: object[], action: Action, ...args: Array<any>) {\n    const store = this.store;\n\n    if (action.mergeData && values.length === 1 && values[0]) {\n      store.updateData(values[0]);\n    }\n\n    const dialog = store.action.dialog as any;\n    if (\n      dialog &&\n      dialog.onConfirm &&\n      dialog.onConfirm(values, action, ...args) === false\n    ) {\n      return;\n    }\n\n    store.closeDialog(true);\n  }\n\n  handleDialogClose(confirmed = false) {\n    const store = this.store;\n    store.closeDialog(confirmed);\n  }\n\n  handleDrawerConfirm(values: object[], action: Action, ...args: Array<any>) {\n    const store = this.store;\n\n    if (action.mergeData && values.length === 1 && values[0]) {\n      store.updateData(values[0]);\n    }\n\n    const drawer = store.action.drawer as any;\n    if (\n      drawer &&\n      drawer.onConfirm &&\n      drawer.onConfirm(values, action, ...args) === false\n    ) {\n      return;\n    }\n\n    store.closeDrawer();\n  }\n\n  handleDrawerClose() {\n    const store = this.store;\n    store.closeDrawer();\n  }\n\n  openFeedback(dialog: any, ctx: any) {\n    return new Promise(resolve => {\n      const store = this.store;\n      store.setCurrentAction({\n        type: 'button',\n        actionType: 'dialog',\n        dialog: dialog\n      });\n      store.openDialog(ctx, undefined, confirmed => {\n        resolve(confirmed);\n      });\n    });\n  }\n\n  reloadTarget(scoped: IScopedContext, target: string, data?: any) {\n    scoped.reload(target, data);\n  }\n\n  render() {\n    const {pathPrefix, schema, ...rest} = this.props;\n    const store = this.store;\n\n    if (store.runtimeError) {\n      return (\n        <Alert level=\"danger\">\n          <h3>{this.store.runtimeError?.toString()}</h3>\n          <pre>\n            <code>{this.store.runtimeErrorStack.componentStack}</code>\n          </pre>\n        </Alert>\n      );\n    }\n\n    return (\n      <>\n        {\n          renderChild(pathPrefix!, schema, {\n            ...rest,\n            data: this.store.downStream,\n            onAction: this.handleAction\n          }) as JSX.Element\n        }\n\n        <Spinner size=\"lg\" overlay key=\"info\" show={store.loading} />\n\n        {store.error ? (\n          <Alert level=\"danger\" showCloseButton onClose={store.clearMessage}>\n            {store.msg}\n          </Alert>\n        ) : null}\n\n        {renderChild(\n          'dialog',\n          {\n            ...((store.action as Action) &&\n              ((store.action as Action).dialog as object)),\n            type: 'dialog'\n          },\n          {\n            ...rest,\n            key: 'dialog',\n            data: store.dialogData,\n            onConfirm: this.handleDialogConfirm,\n            onClose: this.handleDialogClose,\n            show: store.dialogOpen,\n            onAction: this.handleAction\n          }\n        )}\n\n        {renderChild(\n          'drawer',\n          {\n            ...((store.action as Action) &&\n              ((store.action as Action).drawer as object)),\n            type: 'drawer'\n          },\n          {\n            ...rest,\n            key: 'drawer',\n            data: store.drawerData,\n            onConfirm: this.handleDrawerConfirm,\n            onClose: this.handleDrawerClose,\n            show: store.drawerOpen,\n            onAction: this.handleAction\n          }\n        )}\n      </>\n    );\n  }\n}\n"
    ]
}