{
    "version": 3,
    "file": "Animation.js",
    "sourceRoot": "",
    "sources": [
        "/src/utils/Animation.ts"
    ],
    "names": [],
    "mappings": "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",
    "sourcesContent": [
        "// 基本上都是从 sortable 那抄的，让拖拽切换有个动画，看起来更流畅。\n// 用法是移动前先 animat.capture(container) 把移动前的位置信息记住\n// 然后移动节点\n// 然后 animate.animateAll(); 计算移动后的位置，然后马上通过 css transform 到原来的位置\n// 然后开始动画到移动后的位置。\n\ninterface Rect {\n  top: number;\n  left: number;\n  bottom: number;\n  right: number;\n  width: number;\n  height: number;\n}\n\ninterface AnimationState {\n  rect: Rect;\n  target: HTMLElement;\n}\n\nfunction userAgent(pattern: RegExp): any {\n  if (typeof window !== 'undefined' && window.navigator) {\n    return !!(/*@__PURE__*/ navigator.userAgent.match(pattern));\n  }\n}\n\nconst IE11OrLess = userAgent(\n  /(?:Trident.*rv[ :]?11\\.|msie|iemobile|Windows Phone)/i\n);\n// const Edge = userAgent(/Edge/i);\n// const FireFox = userAgent(/firefox/i);\n// const Safari =\n//   userAgent(/safari/i) && !userAgent(/chrome/i) && !userAgent(/android/i);\n// const IOS = userAgent(/iP(ad|od|hone)/i);\n// const ChromeForAndroid = userAgent(/chrome/i) && userAgent(/android/i);\n\nconst AnimationDurtation = 150;\nconst AnimationEasing = 'cubic-bezier(1, 0, 0, 1)';\n\nexport class AnimationManager {\n  animating: boolean = false;\n  animationCallbackId: any;\n  states: Array<AnimationState> = [];\n\n  capture(el: HTMLElement) {\n    // 清空，重复调用，旧的不管了\n    this.states = [];\n\n    let children: Array<HTMLElement> = [].slice.call(el.children);\n    children.forEach(child => {\n      // 如果是 ghost\n      if (child.classList.contains('is-ghost')) {\n        return;\n      }\n\n      const rect = getRect(child)!;\n\n      // 通常是隐藏节点\n      if (!rect.width) {\n        return;\n      }\n\n      let fromRect = {...rect};\n\n      const state: AnimationState = {\n        target: child,\n        rect\n      };\n\n      // 还在动画中\n      if ((child as any).thisAnimationDuration) {\n        let childMatrix = matrix(child);\n\n        if (childMatrix) {\n          fromRect.top -= childMatrix.f;\n          fromRect.left -= childMatrix.e;\n        }\n      }\n\n      (child as any).fromRect = fromRect;\n      this.states.push(state);\n    });\n  }\n\n  animateAll(callback?: () => void) {\n    this.animating = false;\n    let animationTime = 0;\n\n    this.states.forEach(state => {\n      let time = 0,\n        target = state.target,\n        fromRect = (target as any).fromRect,\n        toRect = {\n          ...getRect(target)!\n        },\n        prevFromRect = (target as any).prevFromRect,\n        prevToRect = (target as any).prevToRect,\n        animatingRect = state.rect,\n        targetMatrix = matrix(target);\n\n      if (targetMatrix) {\n        // Compensate for current animation\n        toRect.top -= targetMatrix.f;\n        toRect.left -= targetMatrix.e;\n      }\n\n      (target as any).toRect = toRect;\n\n      if ((target as any).thisAnimationDuration) {\n        // Could also check if animatingRect is between fromRect and toRect\n        if (\n          isRectEqual(prevFromRect, toRect) &&\n          !isRectEqual(fromRect, toRect) &&\n          // Make sure animatingRect is on line between toRect & fromRect\n          (animatingRect.top - toRect.top) /\n            (animatingRect.left - toRect.left) ===\n            (fromRect.top - toRect.top) / (fromRect.left - toRect.left)\n        ) {\n          // If returning to same place as started from animation and on same axis\n          time = calculateRealTime(animatingRect, prevFromRect, prevToRect);\n        }\n      }\n\n      // if fromRect != toRect: animate\n      if (!isRectEqual(toRect, fromRect)) {\n        (target as any).prevFromRect = fromRect;\n        (target as any).prevToRect = toRect;\n\n        if (!time) {\n          time = AnimationDurtation;\n        }\n        this.animate(target, animatingRect, toRect, time);\n      }\n\n      if (time) {\n        this.animating = true;\n        animationTime = Math.max(animationTime, time);\n        clearTimeout((target as any).animationResetTimer);\n        (target as any).animationResetTimer = setTimeout(function () {\n          (target as any).animationTime = 0;\n          (target as any).prevFromRect = null;\n          (target as any).fromRect = null;\n          (target as any).prevToRect = null;\n          (target as any).thisAnimationDuration = null;\n        }, time);\n        (target as any).thisAnimationDuration = time;\n      }\n    });\n\n    clearTimeout(this.animationCallbackId);\n    if (!this.animating) {\n      if (typeof callback === 'function') callback();\n    } else {\n      this.animationCallbackId = setTimeout(() => {\n        this.animating = false;\n        if (typeof callback === 'function') callback();\n      }, animationTime);\n    }\n    this.states = [];\n  }\n\n  animate(\n    target: HTMLElement,\n    currentRect: Rect,\n    toRect: Rect,\n    duration: number\n  ) {\n    if (duration) {\n      let affectDisplay = false;\n      css(target, 'transition', '');\n      css(target, 'transform', '');\n      let translateX = currentRect.left - toRect.left,\n        translateY = currentRect.top - toRect.top;\n\n      (target as any).animatingX = !!translateX;\n      (target as any).animatingY = !!translateY;\n\n      css(\n        target,\n        'transform',\n        'translate3d(' + translateX + 'px,' + translateY + 'px,0)'\n      );\n\n      if (css(target, 'display') === 'inline') {\n        affectDisplay = true;\n        css(target, 'display', 'inline-block');\n      }\n\n      target.offsetWidth; // repaint\n\n      css(\n        target,\n        'transition',\n        'transform ' +\n          duration +\n          'ms' +\n          (AnimationEasing ? ' ' + AnimationEasing : '')\n      );\n      css(target, 'transform', 'translate3d(0,0,0)');\n      typeof (target as any).animated === 'number' &&\n        clearTimeout((target as any).animated);\n      (target as any).animated = setTimeout(function () {\n        css(target, 'transition', '');\n        css(target, 'transform', '');\n        affectDisplay && css(target, 'display', '');\n        (target as any).animated = false;\n\n        (target as any).animatingX = false;\n        (target as any).animatingY = false;\n      }, duration);\n    }\n  }\n}\n\nfunction matrix(el: HTMLElement) {\n  let appliedTransforms = '';\n  if (typeof el === 'string') {\n    appliedTransforms = el;\n  } else {\n    let transform = css(el, 'transform');\n\n    if (transform && transform !== 'none') {\n      appliedTransforms = transform + ' ' + appliedTransforms;\n    }\n  }\n\n  const matrixFn =\n    window.DOMMatrix ||\n    window.WebKitCSSMatrix ||\n    (window as any).CSSMatrix ||\n    (window as any).MSCSSMatrix;\n\n  /*jshint -W056 */\n  return matrixFn && new matrixFn(appliedTransforms);\n}\n\nfunction css(el: HTMLElement, prop: string, val?: any) {\n  let style = el && el.style;\n\n  if (style) {\n    if (val === void 0) {\n      if (document.defaultView && document.defaultView.getComputedStyle) {\n        val = document.defaultView.getComputedStyle(el, '');\n      } else if ((el as any).currentStyle) {\n        val = (el as any).currentStyle;\n      }\n\n      return prop === void 0 ? val : val[prop];\n    } else {\n      if (!(prop in style) && prop.indexOf('webkit') === -1) {\n        prop = '-webkit-' + prop;\n      }\n\n      (style as any)[prop] = val + (typeof val === 'string' ? '' : 'px');\n    }\n  }\n}\n\nfunction isRectEqual(rect1: Rect, rect2: Rect) {\n  return (\n    Math.round(rect1.top) === Math.round(rect2.top) &&\n    Math.round(rect1.left) === Math.round(rect2.left) &&\n    Math.round(rect1.height) === Math.round(rect2.height) &&\n    Math.round(rect1.width) === Math.round(rect2.width)\n  );\n}\n\nfunction calculateRealTime(animatingRect: Rect, fromRect: Rect, toRect: Rect) {\n  return (\n    (Math.sqrt(\n      Math.pow(fromRect.top - animatingRect.top, 2) +\n        Math.pow(fromRect.left - animatingRect.left, 2)\n    ) /\n      Math.sqrt(\n        Math.pow(fromRect.top - toRect.top, 2) +\n          Math.pow(fromRect.left - toRect.left, 2)\n      )) *\n    AnimationDurtation\n  );\n}\n\nfunction getWindowScrollingElement() {\n  let scrollingElement = document.scrollingElement;\n\n  if (scrollingElement) {\n    return scrollingElement;\n  } else {\n    return document.documentElement;\n  }\n}\n\nfunction getRect(\n  el: HTMLElement,\n  relativeToContainingBlock?: boolean,\n  relativeToNonStaticParent?: boolean,\n  undoScale?: boolean,\n  container?: HTMLElement\n) {\n  if (!el.getBoundingClientRect && (el as any) !== window) return;\n\n  let elRect, top, left, bottom, right, height, width;\n\n  if ((el as any) !== window && el !== getWindowScrollingElement()) {\n    elRect = el.getBoundingClientRect();\n    top = elRect.top;\n    left = elRect.left;\n    bottom = elRect.bottom;\n    right = elRect.right;\n    height = elRect.height;\n    width = elRect.width;\n  } else {\n    top = 0;\n    left = 0;\n    bottom = window.innerHeight;\n    right = window.innerWidth;\n    height = window.innerHeight;\n    width = window.innerWidth;\n  }\n\n  if (\n    (relativeToContainingBlock || relativeToNonStaticParent) &&\n    (el as any) !== window\n  ) {\n    // Adjust for translate()\n    container = container || (el.parentNode as HTMLElement);\n\n    // solves #1123 (see: https://stackoverflow.com/a/37953806/6088312)\n    // Not needed on <= IE11\n    if (!IE11OrLess) {\n      do {\n        if (\n          container &&\n          container.getBoundingClientRect &&\n          (css(container, 'transform') !== 'none' ||\n            (relativeToNonStaticParent &&\n              css(container, 'position') !== 'static'))\n        ) {\n          let containerRect = container.getBoundingClientRect();\n\n          // Set relative to edges of padding box of container\n          top -=\n            containerRect.top + parseInt(css(container, 'border-top-width'));\n          left -=\n            containerRect.left + parseInt(css(container, 'border-left-width'));\n          bottom = top + (elRect as any).height;\n          right = left + (elRect as any).width;\n\n          break;\n        }\n        /* jshint boss:true */\n      } while ((container = container.parentNode as HTMLElement));\n    }\n  }\n\n  if (undoScale && (el as any) !== window) {\n    // Adjust for scale()\n    let elMatrix = matrix(container || el),\n      scaleX = elMatrix && elMatrix.a,\n      scaleY = elMatrix && elMatrix.d;\n\n    if (elMatrix) {\n      top /= scaleY;\n      left /= scaleX;\n\n      width /= scaleX;\n      height /= scaleY;\n\n      bottom = top + height;\n      right = left + width;\n    }\n  }\n\n  return {\n    top: top,\n    left: left,\n    bottom: bottom,\n    right: right,\n    width: width,\n    height: height\n  };\n}\n\nexport default new AnimationManager();\n"
    ]
}