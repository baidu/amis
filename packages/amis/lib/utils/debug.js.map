{
    "version": 3,
    "file": "debug.js",
    "sourceRoot": "",
    "sources": [
        "/src/utils/debug.tsx"
    ],
    "names": [],
    "mappings": "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",
    "sourcesContent": [
        "/**\n * amis 运行时调试功能，为了避免循环引用，这个组件不要依赖 amis 里的组件\n */\n\nimport React, {Component, useEffect, useRef, useState} from 'react';\nimport cx from 'classnames';\nimport {findDOMNode, render} from 'react-dom';\nimport JsonView from 'react-json-view';\nimport {autorun, observable} from 'mobx';\nimport {observer} from 'mobx-react';\nimport {uuidv4} from './helper';\nimport position from './position';\n\nclass Log {\n  @observable cat = '';\n  @observable level = '';\n  @observable msg = '';\n  @observable ext? = '';\n}\n\nclass AMISDebugStore {\n  /**\n   * 当前 tab\n   */\n  @observable tab: 'log' | 'inspect' = 'log';\n\n  /**\n   * 显示位置，默认在右边\n   */\n  @observable position: 'left' | 'right' = 'right';\n\n  /**\n   * 组件日志\n   */\n  @observable logs: Log[] = [];\n\n  /**\n   * Debug 面板是否展开\n   */\n  @observable isExpanded = false;\n\n  /**\n   * 是否是 inspect 模式，在这个模式下可以查看数据域\n   */\n  @observable inspectMode = false;\n\n  /**\n   * 当前高亮的组件节点 id\n   */\n  @observable hoverId: string;\n\n  /**\n   * 当前选中的组件节点 id\n   */\n  @observable activeId: string;\n}\n\nconst store = new AMISDebugStore();\n\ninterface ComponentInspect {\n  name: string;\n  component: any;\n}\n\n// 存储组件信息用于 debug\nconst ComponentInfo = {} as {[propName: string]: ComponentInspect};\n\nconst LogView = observer(({store}: {store: AMISDebugStore}) => {\n  const logs = store.logs;\n  return (\n    <>\n      {logs.map((log, index) => {\n        return (\n          <div className=\"AMISDebug-logLine\" key={`log-${index}`}>\n            <div className=\"AMISDebug-logLineMsg\">\n              [{log.cat}] {log.msg}\n            </div>\n            {log.ext ? (\n              <JsonView\n                name={null}\n                theme=\"monokai\"\n                src={JSON.parse(log.ext)}\n                collapsed={true}\n                enableClipboard={false}\n                displayDataTypes={false}\n                iconStyle=\"square\"\n              />\n            ) : null}\n          </div>\n        );\n      })}\n    </>\n  );\n});\n\nconst AMISDebug = observer(({store}: {store: AMISDebugStore}) => {\n  const activeId = store.activeId;\n  const activeComponentInspect = ComponentInfo[activeId];\n\n  // 收集数据域里的数据\n  let start = activeComponentInspect?.component?.props?.data || {};\n  const stacks = [start];\n\n  while (Object.getPrototypeOf(start) !== Object.prototype) {\n    const superData = Object.getPrototypeOf(start);\n    if (Object.prototype.toString.call(superData) !== '[object Object]') {\n      break;\n    }\n    stacks.push(superData);\n    start = superData;\n  }\n\n  const stackDataView = [];\n  if (Object.keys(stacks[0]).length || stacks.length > 1) {\n    let level = 0;\n    for (const stack of stacks) {\n      stackDataView.push(\n        <div key={`data-${level}`}>\n          <h3>Data Level-{level}</h3>\n          <JsonView\n            key={`dataview-${stack}`}\n            name={null}\n            theme=\"monokai\"\n            src={stack}\n            collapsed={level === 0 ? false : true}\n            enableClipboard={false}\n            displayDataTypes={false}\n            iconStyle=\"square\"\n          />\n        </div>\n      );\n      level += 1;\n    }\n  }\n\n  const panelRef = useRef(null);\n\n  const [isResizing, setResizing] = useState(false);\n\n  const [startX, setStartX] = useState(0);\n\n  const [panelWidth, setPanelWidth] = useState(0);\n\n  useEffect(() => {\n    const handleMouseUp = () => {\n      setResizing(false);\n    };\n    const handleMouseMove = (e: MouseEvent) => {\n      if (!isResizing) {\n        return;\n      }\n      const xOffset =\n        store.position === 'right' ? e.clientX - startX : startX - e.clientX;\n      const panel = panelRef.current! as HTMLElement;\n      const targetWidth = Math.max(200, panelWidth - xOffset);\n      panel.style.width = targetWidth + 'px';\n      if (e.stopPropagation) e.stopPropagation();\n      if (e.preventDefault) e.preventDefault();\n      e.cancelBubble = true;\n      return false;\n    };\n    if (isResizing) {\n      document.addEventListener('mousemove', handleMouseMove);\n      document.addEventListener('mouseup', handleMouseUp);\n    }\n\n    return () => {\n      if (isResizing) {\n        document.removeEventListener('mousemove', handleMouseMove);\n        document.removeEventListener('mouseup', handleMouseUp);\n      }\n    };\n  }, [isResizing]);\n\n  return (\n    <div\n      className={cx('AMISDebug', {\n        'is-expanded': store.isExpanded,\n        'is-left': store.position === 'left'\n      })}\n      ref={panelRef}\n    >\n      <div\n        className=\"AMISDebug-toggle\"\n        title=\"open debug\"\n        onClick={() => {\n          store.isExpanded = true;\n        }}\n      >\n        {store.isExpanded ? (\n          <i className=\"fas fa-times\"></i>\n        ) : (\n          <i className=\"fas fa-bug\"></i>\n        )}\n      </div>\n      <div className={cx('AMISDebug-content')}>\n        <div\n          className=\"AMISDebug-close\"\n          title=\"Close\"\n          onClick={() => {\n            store.isExpanded = false;\n          }}\n        >\n          <i className=\"fas fa-times\" />\n        </div>\n        <div\n          className=\"AMISDebug-resize\"\n          onMouseDown={event => {\n            setStartX(event.clientX);\n            setPanelWidth(\n              parseInt(\n                getComputedStyle(panelRef.current!).getPropertyValue('width'),\n                10\n              )\n            );\n            setResizing(true);\n          }}\n        ></div>\n        <div className=\"AMISDebug-tab\">\n          <button\n            className={cx({active: store.tab === 'log'})}\n            onClick={() => {\n              store.tab = 'log';\n            }}\n          >\n            Log\n          </button>\n          <button\n            className={cx({active: store.tab === 'inspect'})}\n            onClick={() => {\n              store.tab = 'inspect';\n            }}\n          >\n            Inspect\n          </button>\n        </div>\n        <div className=\"AMISDebug-changePosition\">\n          {store.position === 'right' ? (\n            <i\n              className=\"fas fa-chevron-left\"\n              title=\"move to left\"\n              onClick={() => {\n                store.position = 'left';\n              }}\n            />\n          ) : (\n            <i\n              className=\"fas fa-chevron-right\"\n              title=\"move to right\"\n              onClick={() => {\n                store.position = 'right';\n              }}\n            />\n          )}\n        </div>\n        {store.tab === 'log' ? (\n          <div className=\"AMISDebug-log\">\n            <button\n              onClick={() => {\n                store.logs = [];\n              }}\n            >\n              Clear Log\n            </button>\n            <LogView store={store} />\n          </div>\n        ) : null}\n        {store.tab === 'inspect' ? (\n          <div className=\"AMISDebug-inspect\">\n            {activeId ? (\n              <>\n                <h3>\n                  Component:{' '}\n                  <span className=\"primary\">{activeComponentInspect.name}</span>\n                </h3>\n                {stackDataView}\n              </>\n            ) : (\n              'Click component to display inspect'\n            )}\n          </div>\n        ) : null}\n      </div>\n    </div>\n  );\n});\n\n/**\n * 鼠标移动到某个组件的效果\n */\nfunction handleMouseMove(e: MouseEvent) {\n  if (!store.isExpanded) {\n    return;\n  }\n  const dom = e.target as HTMLElement;\n  const target = dom.closest(`[data-debug-id]`);\n  if (target) {\n    store.hoverId = target.getAttribute('data-debug-id')!;\n  }\n}\n\n/**\n *  点选某个组件\n */\nfunction handleMouseclick(e: MouseEvent) {\n  if (!store.isExpanded) {\n    return;\n  }\n  const dom = e.target as HTMLElement;\n  const target = dom.closest(`[data-debug-id]`);\n  if (target) {\n    store.activeId = target.getAttribute('data-debug-id')!;\n    store.tab = 'inspect';\n  }\n}\n\n// hover 及点击后的高亮\nconst amisHoverBox = document.createElement('div');\namisHoverBox.className = 'AMISDebug-hoverBox';\nconst amisActiveBox = document.createElement('div');\namisActiveBox.className = 'AMISDebug-activeBox';\n\nautorun(() => {\n  const hoverId = store.hoverId;\n  const hoverElement = document.querySelector(\n    `[data-debug-id=\"${hoverId}\"]`\n  ) as HTMLElement;\n  if (hoverElement) {\n    const offset = position(hoverElement, document.body);\n    amisHoverBox.style.top = `${offset.top}px`;\n    amisHoverBox.style.left = `${offset.left}px`;\n    amisHoverBox.style.width = `${offset.width}px`;\n    amisHoverBox.style.height = `${offset.height}px`;\n  }\n});\n\nautorun(() => {\n  const activeId = store.activeId;\n  const activeElement = document.querySelector(\n    `[data-debug-id=\"${activeId}\"]`\n  ) as HTMLElement;\n  if (activeElement) {\n    const offset = position(activeElement, document.body);\n    amisActiveBox.style.top = `${offset.top}px`;\n    amisActiveBox.style.left = `${offset.left}px`;\n    amisActiveBox.style.width = `${offset.width}px`;\n    amisActiveBox.style.height = `${offset.height}px`;\n  }\n});\n\n// 页面中只能有一个实例\nlet isEnabled = false;\n\nexport function enableDebug() {\n  if (isEnabled) {\n    return;\n  }\n  isEnabled = true;\n\n  const amisDebugElement = document.createElement('div');\n  document.body.appendChild(amisDebugElement);\n  const element = <AMISDebug store={store} />;\n  render(element, amisDebugElement);\n\n  document.body.appendChild(amisHoverBox);\n  document.body.appendChild(amisActiveBox);\n  document.addEventListener('mousemove', handleMouseMove);\n  document.addEventListener('click', handleMouseclick);\n}\n\ninterface DebugWrapperProps {\n  renderer: any;\n}\n\nexport class DebugWrapper extends Component<DebugWrapperProps> {\n  componentDidMount() {\n    const root = findDOMNode(this) as HTMLElement;\n    if (!root) {\n      return;\n    }\n    const {renderer} = this.props;\n    const debugId = uuidv4();\n    root.setAttribute('data-debug-id', debugId);\n    ComponentInfo[debugId] = {\n      name: renderer.name,\n      component: this.props.children\n    };\n  }\n\n  render() {\n    return this.props.children;\n  }\n}\n\ntype Category = 'api' | 'event';\n\n/**\n * 一般调试日志\n * @param msg 简单消息\n * @param ext 扩展信息\n */\nexport function debug(cat: Category, msg: string, ext?: object) {\n  if (!isEnabled) {\n    return;\n  }\n  const log = {\n    cat,\n    level: 'debug',\n    msg: msg,\n    ext: JSON.stringify(ext)\n  };\n  console.groupCollapsed('amis debug', msg);\n  console.trace(log);\n  console.groupEnd();\n\n  store.logs.push(log);\n}\n\n/**\n * 警告日志\n * @param msg 简单消息\n * @param ext 扩展信息\n */\nexport function warning(cat: Category, msg: string, ext?: object) {\n  if (!isEnabled) {\n    return;\n  }\n  const log = {\n    cat,\n    level: 'warn',\n    msg: msg,\n    ext: JSON.stringify(ext)\n  };\n\n  console.groupCollapsed('amis debug', msg);\n  console.trace(log);\n  console.groupEnd();\n  store.logs.push(log);\n}\n"
    ]
}