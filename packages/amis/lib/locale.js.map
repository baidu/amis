{
    "version": 3,
    "file": "locale.js",
    "sourceRoot": "",
    "sources": [
        "/src/locale.tsx"
    ],
    "names": [],
    "mappings": "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",
    "sourcesContent": [
        "// 多语言支持\nimport React from 'react';\nimport hoistNonReactStatic from 'hoist-non-react-statics';\nimport {resolveVariable} from './utils/tpl-builtin';\n\nexport type TranslateFn<T = any> = (str: T, data?: object) => T;\n\ninterface LocaleConfig {\n  [propsName: string]: string;\n}\n\nlet defaultLocale: string = 'zh-CN';\n\nconst locales: {\n  [propName: string]: LocaleConfig;\n} = {};\n\nexport function register(name: string, config: LocaleConfig) {\n  locales[name] = config;\n}\n\nconst fns: {\n  [propName: string]: TranslateFn;\n} = {};\n\nfunction format(str: string, data?: object) {\n  return str.replace(/(\\\\)?\\{\\{([\\s\\S]+?)\\}\\}/g, (_, escape, key) => {\n    if (escape) {\n      return _.substring(1);\n    }\n\n    return resolveVariable(key, data || {});\n  });\n}\n\nexport function makeTranslator(locale?: string): TranslateFn {\n  if (locale && fns[locale]) {\n    return fns[locale];\n  }\n\n  const fn = (str: any, ...args: any[]) => {\n    if (!str || typeof str !== 'string') {\n      return str;\n    }\n\n    const dict = locales[locale!] || locales[defaultLocale];\n    return format(dict?.[str] || str, ...args);\n  };\n\n  locale && (fns[locale] = fn);\n  return fn;\n}\n\nexport function getDefaultLocale() {\n  return defaultLocale;\n}\n\nexport function setDefaultLocale(loacle: string) {\n  defaultLocale = loacle;\n}\n\nexport interface LocaleProps {\n  locale: string;\n  translate: TranslateFn;\n}\n\nexport const LocaleContext = React.createContext('');\n\nexport function localeable<\n  T extends React.ComponentType<React.ComponentProps<T> & LocaleProps>\n>(ComposedComponent: T) {\n  type OuterProps = JSX.LibraryManagedAttributes<\n    T,\n    Omit<React.ComponentProps<T>, keyof LocaleProps>\n  > & {\n    locale?: string;\n    translate?: (str: string, ...args: any[]) => string;\n  };\n\n  const result = hoistNonReactStatic(\n    class extends React.Component<OuterProps> {\n      static displayName = `I18N(${\n        ComposedComponent.displayName || ComposedComponent.name\n      })`;\n      static contextType = LocaleContext;\n      static ComposedComponent = ComposedComponent as React.ComponentType<T>;\n\n      constructor(props: OuterProps) {\n        super(props);\n\n        this.childRef = this.childRef.bind(this);\n        this.getWrappedInstance = this.getWrappedInstance.bind(this);\n      }\n\n      ref: any;\n\n      childRef(ref: any) {\n        while (ref && ref.getWrappedInstance) {\n          ref = ref.getWrappedInstance();\n        }\n\n        this.ref = ref;\n      }\n\n      getWrappedInstance() {\n        return this.ref;\n      }\n\n      render() {\n        const locale: string =\n          this.props.locale || this.context || defaultLocale;\n        const translate = this.props.translate || makeTranslator(locale);\n        const injectedProps: {\n          locale: string;\n          translate: TranslateFn;\n        } = {\n          locale,\n          translate: translate!\n        };\n        const refConfig = ComposedComponent.prototype?.isReactComponent\n          ? {ref: this.childRef}\n          : {forwardedRef: this.childRef};\n        return (\n          <LocaleContext.Provider value={locale}>\n            <ComposedComponent\n              {...(this.props as JSX.LibraryManagedAttributes<\n                T,\n                React.ComponentProps<T>\n              >)}\n              {...injectedProps}\n              {...refConfig}\n            />\n          </LocaleContext.Provider>\n        );\n      }\n    },\n    ComposedComponent\n  );\n\n  return result as typeof result & {\n    ComposedComponent: T;\n  };\n}\n"
    ]
}