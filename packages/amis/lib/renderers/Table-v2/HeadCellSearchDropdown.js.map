{
    "version": 3,
    "file": "HeadCellSearchDropdown.js",
    "sourceRoot": "",
    "sources": [
        "/src/renderers/Table-v2/HeadCellSearchDropdown.tsx"
    ],
    "names": [],
    "mappings": "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",
    "sourcesContent": [
        "import React from 'react';\nimport {findDOMNode} from 'react-dom';\n\nimport {RendererProps} from '../../factory';\nimport {Action} from '../../types';\nimport {Icon} from '../../components/icons';\nimport {setVariable, createObject} from '../../utils/helper';\nimport {ITableStore} from '../../store/table-v2';\nimport HeadCellDropDown from '../../components/table/HeadCellDropDown';\n\nexport interface QuickSearchConfig {\n  type?: string;\n  controls?: any;\n  tabs?: any;\n  fieldSet?: any;\n  [propName: string]: any;\n}\n\nexport interface HeadCellSearchProps extends RendererProps {\n  name: string;\n  searchable: boolean | QuickSearchConfig;\n  classPrefix: string;\n  onSearch?: (values: object) => void;\n  onAction?: Function;\n  store: ITableStore;\n}\n\nexport class HeadCellSearchDropDown extends React.Component<\n  HeadCellSearchProps,\n  any\n> {\n  formItems: Array<string> = [];\n  constructor(props: HeadCellSearchProps) {\n    super(props);\n\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.handleAction = this.handleAction.bind(this);\n  }\n\n  buildSchema() {\n    const {searchable, sortable, name, label, translate: __} = this.props;\n\n    let schema: any;\n\n    if (searchable === true) {\n      schema = {\n        title: '',\n        controls: [\n          {\n            type: 'text',\n            name,\n            placeholder: label,\n            clearable: true\n          }\n        ]\n      };\n    } else if (searchable) {\n      if (searchable.controls || searchable.tabs || searchable.fieldSet) {\n        schema = {\n          title: '',\n          ...searchable,\n          controls: Array.isArray(searchable.controls)\n            ? searchable.controls.concat()\n            : undefined\n        };\n      } else {\n        schema = {\n          title: '',\n          className: searchable.formClassName,\n          controls: [\n            {\n              type: searchable.type || 'text',\n              name: searchable.name || name,\n              placeholder: label,\n              ...searchable\n            }\n          ]\n        };\n      }\n    }\n\n    if (schema && schema.controls && sortable) {\n      schema.controls.unshift(\n        {\n          type: 'hidden',\n          name: 'orderBy',\n          value: name\n        },\n        {\n          type: 'button-group',\n          name: 'order',\n          label: __('sort'),\n          options: [\n            {\n              label: __('asc'),\n              value: 'asc'\n            },\n            {\n              label: __('desc'),\n              value: 'desc'\n            }\n          ]\n        }\n      );\n    }\n\n    if (schema) {\n      const formItems: Array<string> = [];\n      schema.controls?.forEach(\n        (item: any) =>\n          item.name &&\n          item.name !== 'orderBy' &&\n          item.name !== 'order' &&\n          formItems.push(item.name)\n      );\n      this.formItems = formItems;\n      schema = {\n        ...schema,\n        type: 'form',\n        wrapperComponent: 'div',\n        actions: [\n          {\n            type: 'button',\n            label: __('reset'),\n            actionType: 'clear-and-submit'\n          },\n\n          {\n            type: 'button',\n            label: __('cancel'),\n            actionType: 'cancel'\n          },\n\n          {\n            label: __('search'),\n            type: 'submit',\n            primary: true\n          }\n        ]\n      };\n    }\n\n    return schema || 'error';\n  }\n\n  handleAction(e: any, action: Action, ctx: object, confirm: Function) {\n    const {onAction} = this.props;\n\n    if (action.actionType === 'cancel' || action.actionType === 'close') {\n      confirm();\n      return;\n    }\n\n    if (action.actionType === 'reset') {\n      confirm();\n      this.handleReset();\n      return;\n    }\n\n    onAction && onAction(e, action, ctx);\n  }\n\n  async handleReset() {\n    const {onSearch, data, name, store, dispatchEvent} = this.props;\n    const values = {...data};\n\n    const rendererEvent = await dispatchEvent(\n      'columnSearch',\n      createObject(data, {\n        ...values\n      })\n    );\n\n    if (rendererEvent?.prevented) {\n      return;\n    }\n\n    this.formItems.forEach(key => setVariable(values, key, undefined));\n\n    if (values.orderBy === name) {\n      values.orderBy = '';\n      values.order = 'asc';\n    }\n\n    store.updateQuery(values);\n\n    onSearch && onSearch(values);\n  }\n\n  async handleSubmit(values: any, confirm: Function) {\n    const {onSearch, name, store, dispatchEvent, data} = this.props;\n\n    if (values.order) {\n      values = {\n        ...values,\n        orderBy: name\n      };\n    }\n\n    const rendererEvent = await dispatchEvent(\n      'columnSearch',\n      createObject(data, {\n        ...values\n      })\n    );\n\n    if (rendererEvent?.prevented) {\n      return;\n    }\n\n    store.updateQuery(values);\n\n    onSearch && onSearch(values);\n\n    confirm();\n  }\n\n  isActive() {\n    const {data, name, orderBy} = this.props;\n\n    return (\n      (orderBy && orderBy === name) || this.formItems.some(key => data?.[key])\n    );\n  }\n\n  render() {\n    const {\n      render,\n      name,\n      data,\n      searchable,\n      store,\n      orderBy,\n      popOverContainer,\n      classPrefix: ns,\n      classnames: cx\n    } = this.props;\n\n    const formSchema = this.buildSchema();\n    const isActive = this.isActive();\n\n    return (\n      <HeadCellDropDown\n        className={`${ns}TableCell-searchBtn`}\n        layerClassName={cx(\n          `${ns}TableCell-searchPopOver`,\n          (searchable as any).className\n        )}\n        active={isActive}\n        filterIcon={<Icon icon=\"search\" className=\"icon\" />}\n        popOverContainer={\n          popOverContainer ? popOverContainer : () => findDOMNode(this)\n        }\n        filterDropdown={({\n          setSelectedKeys,\n          selectedKeys,\n          confirm,\n          clearFilters\n        }) => {\n          return render('quick-search-form', formSchema, {\n            data: {\n              ...data,\n              orderBy,\n              order:\n                orderBy && orderBy === name ? (store as ITableStore).order : ''\n            },\n            onSubmit: (values: object) => this.handleSubmit(values, confirm),\n            onAction: (e: any, action: Action, ctx: object) => {\n              this.handleAction(e, action, ctx, confirm);\n            }\n          }) as JSX.Element;\n        }}\n      ></HeadCellDropDown>\n    );\n  }\n}\n"
    ]
}